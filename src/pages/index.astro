---
import Layout from "@/layouts/Layout.astro";
import { getBlogs } from "@/lib/microcms";

const posts = await getBlogs({ fields: ["id", "title", "category", "publishedAt", "createdAt"] });
---

<Layout>
	<div class="post-list">
		{
			posts.contents.map((post) => {
				const date = post.publishedAt !== undefined ? post.publishedAt : post.createdAt;

				return (
					<div class="post-wrap">
						<div>
							<time class="date" datetime={date}>
								{date}
							</time>
							<span>{post.category !== undefined ? post.category.name : ""}</span>
						</div>
						<h2>{post.title}</h2>
						<a class="post-link" href={`/${post.id}`} />
					</div>
				);
			})
		}
	</div>
</Layout>

<style>
	.post-list {
		display: flex;
		flex-direction: column;
	}

	.post-wrap {
		display: table;
		position: relative;
	}

	.post-wrap:hover {
		text-decoration: underline;
	}

	.date {
		font-size: 15px;
	}

	.post-link {
		display: block;
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
	}
</style>
